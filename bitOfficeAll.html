<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <link id="favicon-link" rel="icon" type="image/x-icon" href="">
    <title>bitOffice</title>
</head>

<body>
    <h1 onclick="alert(license);">bitOffice</h1>
    <nav id="top-nav">
        <button onclick="showMain('main-planner');">&#9742;&#128197;</button>
        <button onclick="showMain('main-notes');">&#128196;</button>
        <button onclick="showMain('main-write');">&#128221;</button>
        <button onclick="showMain('main-tables');">&#9638;</button>
        <button onclick="showMain('main-calculator');">&#128290;</button>
    </nav>
    <main id="delete-me">
        coming ...
    </main>
    <main id="main-planner">
        <h2>Planner</h2>
        <nav id="planner-ribbon">
            <!-- <button onclick="showPlannerDiv('planner-startup');">&#128194;</button>
            <button onclick="showPlannerDiv('planner-contacts-table');">&#9742;</button>
            <button onclick="showPlannerDiv('planner-calendar-start');makeCalendar();">&#128197;</button>
            <button onclick="showPlannerDiv('planner-planner-help');">?</button> -->
            <button onclick="showPlannerDiv('planner-startup');">&#128194;</button>
            <button onclick="showPlannerDiv('planner-contacts-table');">Contacts</button>
            <button onclick="showPlannerDiv('planner-calendar-start');makeCalendar();">Calendar</button>
            <button onclick="showPlannerDiv('planner-planner-help');">?</button>
        </nav>
        <div class="planner-div" id="planner-startup">
            <h3>Load/Save</h3>
            <nav>
                <button id="startup-load-button" onclick="loadCombinedDatabase()">&#128194; Load</button>
                <button id="saveButton" onclick="saveCombinedDatabase()">&#128193; Save</button>
            </nav>
        </div>
        <div class="planner-div" id="planner-planner-help">
            <h3>Planner-Help</h3>
            <p>You can:
            <ul>
                <li>Load/Save your data to its native format. This will save both the Contacts and Calendar in one file.
                </li>
                <li>You can export all contacts to a file containing vCards</li>
                <li>You can a single vCard</li>
                <li>You can export your entire calendar in vCalendar format (.ics format)</li>
                <li>You can export a single event in vCalendar format (.ics format)</li>
            </ul>
            </p>
            <p>
                Most programs like Google Calendar or Microsoft Outlook can import or export these files.
            </p>
            <hr>
            <p>
                <i>Notes on importing:</i>
            </p>

            <p>
                The program only supports a limited number of fields. When importing from a
                different program, any fields not supported will be read into the "Notes" area on Contacts and the
                "Description" area on Calendar entries. Also, photos, audio, and video are not supported.
            </p>
        </div>
        <div class="planner-div" id="planner-contacts-table">
            <h3>Planner-Contacts</h3>
            <nav>
                <!--<button onclick="processCSVClick(contactsTable);">CSV</button>-->

                <button onclick='newContactsEntry();'>+ New Contact</button>
                <nav>
                    <!-- <button onclick="loadOutlookContactsCSV();">&#128194; Import CSV</button>
                    <button onclick="saveOutlookContactsCSV();">&#128193; Export CSV</button> -->
                    <button onclick="importVCF();">&#128193; Import vCards</button>
                    <button onclick="exportVCF();">&#128193; Export vCards</button>
                    <span class="nested-menu">&lrarr;</span>
                </nav>
            </nav>

            <div id="contacts-table" class="table-container"></div>
        </div>
        <div class="planner-div" id="planner-contacts-form">
            <h3>Planner-Contacts Form</h3>
            <div id="contacts-edit-form-message"></div>
            <div id="contacts-edit-form"></div>
            <nav>
                <button onclick='saveContactsEntry();'>Save</button>
                <button onclick='deleteContactsEntry();'>Delete</button>
                <button onclick='cancelContactsEntry();'>Cancel</button>
                <button onclick='exportSingleVCard()'>Export vCard</button>
            </nav>
        </div>
        <div class="planner-div" id="planner-calendar-start">
            <h3>Planner-Calendar</h3>
            <nav>
                <!-- <button onclick="loadOutlookCSV();">&#128194; Import CSV</button>
                <button onclick="createOutlookCSV();">&#128193; Export CSV</button> -->
                <button onclick="importICSCalendar()">&#128194; Import vCalendar</button>
                <button onclick="exportICSCalendar()">&#128193; Export vCalendar</button>
                <button onclick="clearCalendar();">Clear Calendar</button>
                <span class="nested-menu">&lrarr;</span>
            </nav>
            <div id="calendar-container">
                <div><input type='date' id="calendar-date"></div>
                <input id="month-chooser" type="month">
                <div id="special-calendar"></div>
            </div>
        </div>
        <div class="planner-div" id="planner-calendar-table">
            <h3 id="calendar-table-name"></h3>
            <nav>
                <button onclick='newCalendarEntry();'>+ New Entry</button>
                <button onclick="processCalendarHome();">Back to Main Calendar</button>
                <!-- <button onclick="processCalendarCSVClick();">CSV</button> -->
            </nav>
            <div id="calendar-table" class="table-container"></div>
        </div>
        <div class="planner-div" id="planner-calendar-form">
            <h3 id="calendar-edit-form-message"></h3>
            <div id="calendar-edit-form"></div>
            <nav>
                <button onclick='saveCalendarEntry();'>Save</button>
                <button onclick='deleteCalendarEntry();'>Delete</button>
                <button onclick='cancelCalendarEntry();'>Cancel</button>
                <button onclick="exportSingleICalEvent()">Export Event</button>
            </nav>
        </div>
    </main>
    <main id="main-notes">
        <h2>Notes</h2>
        <nav>
            <button onclick="newNotesEntry()">New</button>
            <button onclick="notesLoad()">Load</button>
            <button onclick="notesSave()">Save</button>
            <button id="copy" onclick="copyToClipBoard(document.getElementById('note').value);">Copy</button>
            <button onclick="printNotesDiv('note');">&#128424;</button>
            <button class="plus-minus" onclick="changeFontSize(this);">-</button>
            <button class="plus-minus" onclick="changeFontSize(this);">+</button>
            <button onclick="simulateUndo()">&#10226;</button>
            <button onclick="simulateRedo()">&#10227;</button>
        </nav>
        <textarea id="note" rows="10" placeholder="your notes here"></textarea>
    </main>
    <main id="main-write">
        <h2>Write</h2>
        <nav id="file-bar">
            <button onclick="newDocument();">New</button>
            <button onclick="writeLoad();">Load</button>
            <button onclick="writeDataToJSON();">Save</button>
            <button onclick="exportToHTML()">Export</button>
            <button onclick="printDiv('document-parent');//window.print()">&#128424;</button>
        </nav>
        <nav id="document-settings">
            <button class="mono" onclick='processSelectedText(this);'>Mono</button>
            <button class="serif" onclick='processSelectedText(this);'>Serif</button>
            <button class="sans" onclick='processSelectedText(this);'>Sans</button>
            <button onclick='processSelectedText(this);//decrease font'><sup>A</sup>A</button>
            <button onclick='processSelectedText(this);//increase font;'><sub>A</sub>A</button>
            <button onclick='processSelectedText(this);//inc margin;'>&rarrb;&larrb;</button>
            <button onclick='processSelectedText(this);//dec margin;'>&larrb;&rarrb;</button>
            <button onclick='processSelectedText(this);//align left;'>&#8666;</button>
            <button onclick='processSelectedText(this);//align center;'>&#8667;&#8666;</button>
            <button onclick='processSelectedText(this);//align right;'>&#8667;</button>
            <button id="spell-check" onclick='processSelectedText(this);//spellcheck;'>&check;</button>
        </nav>
        <nav id="edit-bar">
            <button onclick='processSelectedText(this);'><b>B</b></button>
            <button onclick='processSelectedText(this);'><u>U</u></button>
            <button onclick='processSelectedText(this);'><em>I</em></button> &nbsp;
            <button onclick='processSelectedText(this);'>&#8633;</button>
            <button onclick='processSelectedText(this);//paragraph;'>&para;</button>
            <button onclick='processSelectedText(this);'>H1</button>
            <button onclick='processSelectedText(this);'>H2</button>
            <button onclick='processSelectedText(this);'>H3</button> &nbsp;
            <button onclick='processSelectedText(this);//horizontal rule'>&#8213;</button>
            <button onclick='processSelectedText(this);//bullet;'>&bullet;</button> &nbsp;
            <button onclick='processSelectedText(this);//undo;'>&#10226;</button>
            <button onclick="writeRedo()">&#10227;</button>
        </nav>
        <textarea id="text-editor" spellcheck="false" oninput="writeUpdateResult();"></textarea>
        <div id="document-parent">
            <div id="document-result"></div>
        </div>
    </main>
    <main id="main-tables">
        <h2>Tables</h2>
        <nav>
            <button onclick="tablesNewTable();">New</button>
            <button onclick="tablesLoad();">Load</button>
            <button onclick="tablesSave();">Save</button>
            <button onclick="tablesCopyCSVToClipboard()">Copy</button>
            <button onclick="showTablesDiv('tables-help');">?</button>
        </nav>
        <div class="tables-div" id="tables-tables-table">

            <div class="table-container">
                <table id="tables-table">
                </table>
            </div>
        </div>
        <div class="tables-div" id="tables-tables-header-form">
            <!-- <h2>Tables</h2> -->
            <div>
                <h3>Column: <span id="tables-current-header">header name here</span></h3>

                <div class="surround-box">
                    <button onclick="updateHeaderName();">Change name to:</button>
                    <input id="tables-new-header-name" type="text" placeholder="name">
                </div>
                <div class="surround-box">
                    <button onclick="deleteColumn();">Delete Column</button>
                    <button onclick="copyColumn()">Copy Column</button>
                </div>
                <div class="surround-box">
                    <button onclick="moveColumn()">Move To Column</button><select id="move-column"></select>
                </div>
                <div>
                    <button onclick="calculateTotal()">Add Total</button>
                    <button onclick="calculateAverage()">Compute Average</button>
                </div>
                <div>
                    <button onclick="tablesSort(1)">Sort Ascending &uarr;</button>
                    <button onclick="tablesSort(-1)">Sort Descending &darr;</button>
                </div>
                <div>
                    <button onclick="tablesCancel()">Cancel</button>
                </div>
            </div>
        </div>
        <div class="tables-div" id="tables-tables-row-form">
            <!-- <h2>Tables</h2> -->
            <div>
                <h3>Row: <span id="tables-current-row">row number here</span></h3>
                <div>
                    <button onclick="deleteRow()">Delete Row</button>
                    <button onclick="copyRow()">Copy Row</button>
                </div>
                <div>
                    <button onclick="moveRow()">Move To Row</button>
                    <select id="move-row"></select>
                </div>
                <div>
                    <button onclick="tablesCancel()">Cancel</button>
                </div>
            </div>
        </div>
        <div class="tables-div" id="tables-help">
            <p>
            <h3>Tables-Help</h3>
            </p>
            <p>
            <nav><button onclick="showTablesDiv('tables-tables-table');">Back To Table</button></nav>
            </p>
            <p>FORMATTING RULES:</p>
            <p>When Saving:
            <ol>
                <li>All cells are quoted text.
                </li>
                <li>Interior double quotes in cells are converted like this: "-&gt;""</li>
            </ol>
            </p>


            <p>If loading CSV from other apps:
            <ol>
                <li>Cells should all be text type.</li>
                <li>Quote all text strings when saving is best practice.</li>
                <li>There should be no spaces or tabs between the comma delimiter.</li>
                <li>Interior double quotation marks (i.e. ") in a cell should be stored as ""</li>
            </ol>
            </p>
            <p>
                For example, these 2 cell contents:
                <pre>  She said "Yeah, Yeah, Yeah",Hi</pre>
            </p>
            <p>
                Would be stored as <pre>  "She said ""Yeah, Yeah, Yeah""","Hi"</pre>
            </p>
            <hr>
            <p>
                <i>Notes on CSV:</i>
            </p>
            <p>
                There is no universal standard among programs, but this program uses the following standards 
                adapted from <a href="https://en.wikipedia.org/wiki/Comma-separated_values#Standardization" target="_blank">RFC 4180 and MIME standards</a>.:
                <ul>
                    <li>Each record should contain the same number of comma-separated fields.</li>
                    <li>Any field may be quoted (with double quotes).</li>
                    <li>If double-quotes are used to enclose fields, then a double-quote in a field must be represented by two double-quote characters. (internal " is escaped with "")</li>
                    <li>Some type of carriage return/line feed must be used- this program uses the "\n" convention, not "\r\n".</li>
                </ul>
            </p>
        </div>
    </main>
    <main id="main-calculator">
        <h2>Calculator</h2>
        <input type=text id='calculator-input'>
        <nav id="calc-clr">
            <button class="special-calculator-button" id="clear-calc">CLR</button>
            <button id="remove-last-char">&larr;</button>
        </nav>

        <div id="last-calculator-expression"></div>
        <table id="calculator-table">
            <tr>
                <td><button class='build-calc-string'>7</button></td>
                <td><button class='build-calc-string'>8</button></td>
                <td><button class='build-calc-string'>9</button></td>
                <td><button class='build-calc-string'>/</button></td>
            </tr>
            <tr>
                <td><button class='build-calc-string'>4</button></td>
                <td><button class='build-calc-string'>5</button></td>
                <td><button class='build-calc-string'>6</button></td>
                <td><button class='build-calc-string'>*</button></td>
            </tr>
            <tr>
                <td><button class='build-calc-string'>1</button></td>
                <td><button class='build-calc-string'>2</button></td>
                <td><button class='build-calc-string'>3</button></td>
                <td><button class='build-calc-string'>-</button></td>
            </tr>
            <tr>
                <td><button class='build-calc-string'>0</button></td>
                <td><button class='build-calc-string'>.</button></td>
                <td><button class="special-calculator-button" id="equals-button">=</button></td>
                <td><button class='build-calc-string'>+</button></td>
            </tr>
        </table>
    </main>


    <footer onclick="alert(license)">bitOffice &copy; 2022</footer>
    <!--
    <script src="globalVariables.js"></script>
    <script src="commonFunctions.js"></script>
    <script src="notes_javascript.js"></script>
    <script src="write_javascript.js"></script>
    <script src="tables_javascript.js"></script>
    <script src="contacts_javascript.js"></script>
    <script src="calculator_javascript.js"></script>

    -->
    <script src="globalVariables.js"></script>
    <script src="csvreaderwriter.js"></script>
    <script src="commonFunctions.js"></script>
    <script src="planner.js"></script>

    <script src="nestedmenu.js"></script>


    <script src="notes.js"></script>
<script src="write.js"></script>
<script src="tables.js"></script>
<script src="calculator.js"></script>
    <script>

        showPlannerDiv('planner-calendar-start');
        makeFavicon("p", "white", "mediumblue");
        showMain('main-planner');
        window.onbeforeunload = askConfirm;
        // alert("Load your planner file to start.");
    </script>


</body>

</html>